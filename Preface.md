日益专业化和多样化带来了大量的专着和教科书或越来越专业的主题。 然而，数学和相关领域知识的“树”并不是仅仅通过新的分支而增长的。 事实上，经常发生的情况是，原本认为完全不同的分支突然之间相互关联。

此外，近年来应用于各种科学的数学的复杂程度和水平发生了巨大变化：测度理论被（非平凡地）用于区域和理论经济学； 代数几何与物理相互作用；  Minkowsky引理，编码理论和水的结构在包装和覆盖理论中相互结合； 量子场、晶体缺陷和数学规划受益于同伦理论； 李代数与过滤有关； 预测和电气工程可以使用斯坦因空间。 而除此之外，还有诸如“实验数学”、“CFD”、“完全可积系统”、“混沌、协同和大尺度秩序”等新兴分支学科，几乎不可能融入现有的分类方案。 他们借鉴了广泛不同的数学部分。 该计划，数学及其应用，致力于新兴（子）学科和此类（新）相互关系，如 exempla gratia

在几个不同的数学和/或科学专业领域中发挥重要作用的中心概念； 

从一个科学努力领域到另一个领域的结果和想法的新应用；

一个研究领域的结果、问题和概念对另一个领域的发展产生的影响.

数学及其应用程序试图提供符合上述哲学的精心挑选的书籍。 有了这样的书，这些书是刺激性的而不是权威性的，引人入胜的而不是百科全书式的，我们希望为不同领域的从业者之间更好的交流做出贡献。模拟退火是一个完美的例子，说明如何从完全不同的、乍一看完全不相关的领域引入想法可能会产生巨大和意想不到的好处。 在这种情况下，这是一个全新且强大的全局（组合）优化工具。

退火是加热固体并缓慢冷却以消除应变和晶体缺陷的过程。 在这个过程中，固体的自由能被最小化。 初始加热是必要的，以避免陷入局部最小值。 实际上，每个函数都可以被视为某个系统的自由能，因此研究和模仿自然在退火过程中如何达到最小值应该会产生优化算法。 究竟什么是模仿，即模拟，这里在数学上的含义当然在本书中得到了彻底的解释，与（统计）物理学的潜在关系也是如此（后者参见第 4 章）。 结果就是被称为“模拟退火”的工具，自 1982 年问世以来，它已成为全局优化中非常强大的工具。

当然，自然（以及技术）充满了最小化过程，另一个是莫佩尔图斯的最少作用原则，更多的优化工具很可能来自对自然以最少努力实现事物的其他方式的模仿。 事实上，B.S. 中的算法 Razumikhin 的书“规划和经济学中的物理模型和均衡方法”（Reidel 1984）也基于这样的想法。

如上所述，模拟退火作为一种优化工具始于1982年，发展迅速，蓬勃发展，现在似乎已经达到一定的成熟度，见证本卷，该主题的第一本专着。 这并不意味着没有大的引人入胜的问题。

例如，该工具不是灵丹妙药，而且似乎对优化问题的先验条件知之甚少，这些条件说明了模拟退火的性能可能如何。 另一个问题是什么“冷却速度”是最佳的。 对于这些和其他方面，需要经验和专家指导。 本书提供了后者。

### Preface

早在 1953 年，Metropolis 等人。  [MET53j 提出了一种有效模拟固体到热平衡演变的算法。 Kirkpatrick 等人花了将近三十年的时间。  [KIR82j 和 Cerny 独立地 [CER85j 意识到，最小化组合优化问题的成本函数与固体缓慢冷却直至达到其低能量基态之间存在深刻的类比，并且优化过程可以通过以下方式实现 应用大都会标准。  Kirkpatrick 和他的同事通过用能源替代成本并在一系列缓慢降低的温度值下执行 Metropolis 算法，获得了一种组合优化算法，他们称之为“模拟退火”。 从那时起，对该算法及其应用的研究已经发展成为一个独立的研究领域。

  作者近距离见证了该领域的成熟：在飞利浦研究实验室，我们自 1983 年以来一直参与模拟退火的理论和应用研究。大约一年前，我们得出结论，该算法的理论基础已经达到 一定程度的饱和，预计将主要在新应用方面做出重大贡献。 正是出于这个原因，我们认为时机成熟了，可以撰写一篇关于模拟退火理论和应用的综述。 时间确实证明了我们是对的：1986 年，我们统计了几十个关于模拟退火应用的贡献，但几乎没有重大的理论贡献。 此外，过去几年出现了一些简洁的评论和概述：[HAJ85]、[BOU86]、[WIL86a]、[AAR87a] 和 [AAR87b]（最后两个是基于本专着的初步版本），表明 需要审查论文。

本专着的目的是全面介绍算法的理论基础，讨论算法的计算经验，并回顾算法在各个学科中的应用。 关于最后一项，我们甚至没有假装完整地列出所有现有的应用程序：应用程序的领域几乎是开放式的，几乎每个月都会报告新的应用程序。 然而，我们的目标是给出各种各样的应用程序的指示。在撰写有关模拟退火的专着时，该技术已成功应用于许多不同的学科，我们想起了以下轶事

曾几何时，一家旅馆发生火灾，当时正在召开科学会议。 夜深了，所有的客人都睡着了。 碰巧的是，来自不同学科的研究人员参加了这次会议。 第一个被烟雾惊醒的是一位数学家。 他的第一反应是立马跑到洗手间，见水龙头里还有水，他惊呼：“有办法！”。 然而与此同时，物理学家去看了火，仔细看了看，然后回到自己的房间里，取了适量的水，刚好可以把火扑灭。 电子工程师没那么挑剔，开始往火上扔一桶桶水。最后，当生物学家醒来时，他对自己说：“适者生存”，然后他又睡了。

本着这则轶事的精神，我们想向数学家推荐第 2 章（渐近收敛），向物理学家推荐第 4 章和第 5 章（实现方面），向电气工程师推荐第 7 章（解决问题），向组合优化器推荐完整的专着，以及另一个 给生物学家的书

### Chapter 1 Introduction

在过去的几十年中，优化的作用在诸如电气工程、运筹学、计算机科学和通信等不同领域稳步增长。 线性和非线性优化 [WAG75]，即对连续变量函数的最优搜索，在 50 和 60 年代取得了重大突破（最著名的例子是解决线性规划问题的单纯形算法，由 Dantzig 在 1947 [DAN63]）。 组合优化 [PAP82] 的主要结果，即对离散变量函数的最优搜索，主要是在 70 年代获得的。 例如，对于旅行商问题 (TSP) [LAW85j，可能是组合优化中最著名的问题，高质量的近似算法和优化算法在 70 年代都可用（分别为 [LIN73] 和 [GR077j），如今，TSP 在合理的计算时间内（在 mM 370/168 计算机上 CPU 时间少于 10 分钟），最多 318 个城市的问题得到了最优解 [CR080j.

然而，即使在今天，许多大规模组合优化问题也只能在当今的计算机上近似解决，这与其中许多问题已被证明是 NP-hard [GAR79]（或相应的决策问题）密切相关。  NP-完全）。 此类问题不太可能很好解决，即    可以通过一定数量的计算工作来解决，该工作量受问题大小的多项式/函数的限制。  Garey 和 Johnson 的著名著作 [GAR79j，其中引用了 320 个 NP 完全问题，对这些问题进行了广泛的分类。
   NP 完全问题与 P（可在多项式时间内解决的一类问题）中的问题之间的区别似乎与困难问题和简单问题之间的区别密切相关。 计算经验为这种关系提供了更多的证据：当然，虽然存在 0 (1.001 n) 指数时间算法和 0 (n 100) 多项式时间算法等对比的可能性，但这些复杂性似乎从来没有 在实践中发生 [C0083j，[JOHN85aj。

因此，我们面临这样一种情况，在实践中，许多大规模组合优化问题无法求解为最优解，因为寻找最优解需要大量的计算时间（例如，超过 318 个城市的 TSP 的最优解有 没有在文献中发表，并且上述 10 分钟的 CPU 时间只是在对一个 318 个城市的实例进行多年研究之后才出现的）。 一种是被迫使用近似算法或启发式算法，对于这些算法通常不能保证算法找到的解是最优的，但是可以给出计算时间的多项式边界。 因此，最终解决方案的质量知识与计算时间进行权衡。

组合优化问题的一个实例被形式化为一对 $(R, C)$​，其中 $R$​ 是有限的 - 或者可能是可数无限的 - 配置集（也称为配置空间），$C$​ 是成本函数，$C : \mathcal{R} \rightarrow R$  ，它为每个配置分配一个实数。

为方便起见，假设 $C$ 的定义使得 $C$ 的值越低，相应的配置就越好（就优化标准而言），这可以在不失一般性的情况下完成。 现在的问题是找到一个使 $C$ 取其最小值的配置，即一个（最佳）配置 $i_o$ 满足
$$
C_{opt}=C(i_0)=min\\\ C(i)
$$
其中 $C_{opt}$ 表示最佳（最小）成本（例如，对于 TSP，配置对应于推销员的旅行，目标是找到最短的旅行）。

如前所述，在尝试解决组合优化问题时有两种可能的方法。 可以使用优化算法，在可能令人望而却步的计算时间内（对于大型 NP 难问题）产生全局最优解，或者使用近似算法，在可接受的计算时间内产生近似解。 近似算法可以分为两类：针对特定问题量身定制的算法（定制算法），以及适用于各种组合优化问题的通用算法。 为了避免第一类算法的内在缺点（由于问题依赖性，它们的适用性有限），需要有一个通用的近似算法，能够为各种组合优化问题获得接近最优的解决方案。 模拟退火算法可以看作是这样一种算法：它是一种解决组合优化问题的通用优化技术。 该算法基于随机化技术。 然而，它还包含了许多与迭代改进算法相关的方面。 由于这些方面在理解模拟退火算法中起着重要作用，我们首先详细说明迭代改进技术。

迭代改进算法的应用预设了配置的定义、成本函数和生成机制，即通过小扰动生成从配置到另一个配置的转换的简单方法。 生成机制为每个配置 $i$​ 定义了一个邻域 $\mathcal{R}_i$，该邻域由一次转换中可以从 $i$ 到达的所有配置组成。因此，迭代改进也称为邻域搜索或局部搜索 [PAP82j. 该算法现在可以表述如下。 从给定的配置开始，生成一系列迭代，每次迭代包括从当前配置到从当前配置的邻域中选择的配置的可能转换。 如果此相邻配置具有较低的成本，则当前配置由此相邻配置替换，否则选择另一个相邻配置并比较其成本值。 当获得成本不低于其任何邻域的配置时，算法终止。

迭代改进算法的缺点可以表述如下：

• 根据定义，迭代改进算法终止于局部最小值，并且通常没有关于该局部最小值偏离全局最小值的量的信息。  

• 获得的局部最小值取决于初始配置，通常没有可用的指南可供选择。  

• 一般来说，不可能给出计算时间的上限（例如，基于 Lin 的 I!-opt 策略 [LIN65] 的 TSP 迭代改进算法的最坏情况复杂度是一个开放问题 [JOHN85bJ）  .

然而，应该清楚的是，迭代改进确实具有普遍适用的优点：配置、成本函数和生成机制通常很容易定义。 此外，尽管缺少计算时间的上限，但平均而言，可以在少量计算时间内执行一次迭代改进算法（对于一个初始配置）。











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































## 







































